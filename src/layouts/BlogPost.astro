---
import BaseLayout from './BaseLayout.astro';
import { formatDate } from '../utils/date';

interface Props {
  frontmatter: {
    title: string;
    description: string;
    pubDate: string;
    updatedDate?: string;
    heroImage?: string;
    tags?: string[];
  };
}

const { frontmatter } = Astro.props;
const { title, description, pubDate, updatedDate, heroImage, tags = [] } = frontmatter;
---

<BaseLayout title={title} description={description} image={heroImage}>
  <article class="prose mx-auto">
    <header class="mb-8 not-prose">
      <h1 class="text-3xl md:text-4xl font-bold text-[#282728] mb-4">{title}</h1>
      <div class="flex flex-wrap items-center gap-4 text-[#666] text-sm">
        <time datetime={pubDate}>
          Published: {formatDate(pubDate)}
        </time>
        {updatedDate && (
          <time datetime={updatedDate}>
            Updated: {formatDate(updatedDate)}
          </time>
        )}
        <span>•</span>
        <span>{Math.ceil(Astro.props.compiledContent?.().length / 1500) || 5} min read</span>
      </div>
      {tags.length > 0 && (
        <div class="flex flex-wrap gap-2 mt-4">
          {tags.map(tag => (
            <a
              href={`/tags/${tag}`}
              class="px-2 py-1 bg-[#f5f5f5] rounded text-xs text-[#666] hover:text-[#282728] transition-colors"
            >
              #{tag}
            </a>
          ))}
        </div>
      )}
    </header>

    {heroImage && (
      <img
        src={heroImage}
        alt={title}
        class="w-full rounded-lg mb-8"
      />
    )}

    <slot />

    <hr class="my-12" />

    <footer class="not-prose">
      <div class="flex justify-between items-center text-sm text-[#666]">
        <a href="/posts" class="hover:text-[#282728] transition-colors">
          ← Back to all posts
        </a>
        <div class="flex gap-4">
          <a
            href={`https://x.com/intent/post?url=${encodeURIComponent(`https://deepu.blog${Astro.url.pathname}`)}`}
            target="_blank"
            rel="noopener noreferrer"
            class="hover:text-[#282728] transition-colors"
          >
            Share on X
          </a>
        </div>
      </div>
    </footer>
  </article>
</BaseLayout>
